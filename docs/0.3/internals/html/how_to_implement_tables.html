<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>AgentXcpp: How to implement a table</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="doc_logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">AgentXcpp
   &#160;<span id="projectnumber">Version:0.3</span>
   </div>
   <div id="projectbrief">Internals Documentation</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('how_to_implement_tables.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">How to implement a table </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><dl class="section note"><dt>Note</dt><dd>This is a follow-up tutorial to <a class="el" href="how_to_send_notifications.html">How to send notifications and traps</a>.</dd></dl>
<p>So far we learned how to implement single variables and how to send notifications. This tutorial teaches us how an SNMP table can be implemented. We start with the code from the previous tutorials and add a table to the SIMPLE-MIB:</p>
<pre class="fragment">SIMPLE-MIB DEFINITIONS ::= BEGIN

IMPORTS
    OBJECT-TYPE FROM SNMPv2-SMI
    enterprises FROM SNMPv2-SMI
    NOTIFICATION-TYPE FROM SNMPv2-SMI;

simpleCounter OBJECT-TYPE
    SYNTAX INTEGER
    ACCESS read-write
    STATUS current
    DESCRIPTION "A simple counter which is incremented each time
                 it is queried. Starts with 0."
    ::={ enterprises 42 1 }

simpleCounterStatus NOTIFICATION-TYPE
    OBJECTS { simpleCounter }
    STATUS current
    DESCRIPTION "A notification sent each second."
    ::={ enterprises 42 0 1 }

counterChangeTable OBJECT-TYPE
    SYNTAX SEQUENCE OF counterChangeEntry
    ACCESS not-accessible
    STATUS current
    DESCRIPTION "This table lists all changes of the simpleCounter object."
    ::= { enterprises 42 2 }

counterChangeEntry OBJECT-TYPE
    SYNTAX counterChangeEntry
    ACCESS not-accessible
    STATUS current
    DESCRIPTION "An entry within the counterChangeEntry table."
    INDEX { counterChangeEpoch, counterChangeMilliseconds }
    ::= { counterChangeTable 1 }
    counterChangeEntry ::= SEQUENCE {
        counterChangeEpoch               INTEGER,
        counterChangeMilliseconds        INTEGER,
        counterChangeTimeString          DisplayString,
        counterChangeCounterValue        INTEGER
    }

counterChangeEpoch OBJECT-TYPE
    SYNTAX INTEGER
    ACCESS read-only
    STATUS current
    DESCRIPTION "The time at which the change occured.This variable contains 
                 the epoch, i.e. seconds since 1970-01-01, 00:00."
    ::={ counterChangeEntry 1 }

counterChangeMilliseconds OBJECT-TYPE
    SYNTAX INTEGER
    ACCESS read-only
    STATUS current
    DESCRIPTION "The time at which counter changed. This variable contains the 
                 milliseconds since counterChangeEpoch, to increase 
                 precision."
    ::={ counterChangeEntry 2 }

counterChangeTimeString OBJECT-TYPE
    SYNTAX OCTETSTRING
    ACCESS read-only
    STATUS current
    DESCRIPTION "The time (counterChangeEpoch + counterChangeMilliseconds) as 
                 a human-readable string."
    ::={ counterChangeEntry 3 }

counterChangeValue OBJECT-TYPE
    SYNTAX INTEGER
    ACCESS read-only
    STATUS current
    DESCRIPTION "The counter value right after the change."
    ::={ counterChangeEntry 4 }

END
</pre><p>Our table has an entry for each counter change which occurred in the past. The table starts empty and each time the counter changes (i.e. by an SNMP GET or SET request), an entry is added.</p>
<p>Each entry within the table has a timestamp, which consists of the epoch time and a milliseconds component, which is used as index of the entry. This is to show how multiple variables can be used to form the table's index. In addition, the time is reported in an human-readable format (e.g. "2011-09-11, 
12:00:52.77"). Finally, each entry reports the new counter value.</p>
<h1><a class="anchor" id="how_tables_work"></a>
How tables work in agentXcpp</h1>
<p>Technically, our SNMP table is a sequence of counterChangeEntry, which in turn is a structure containing four "real" SNMP variables. The OID of these variables are assembled like this:</p>
<p>&lt;tableOid&gt;.&lt;entrySubOid&gt;.&lt;variableSubOid&gt;.&lt;indexOid&gt;</p>
<p>The &lt;tableOid&gt; is the OID given to the table. The counterChangeTable has the OID enterprises.42.2, which is .1.3.6.1.4.1.42.2.</p>
<p>The &lt;entrySubOid&gt; is a single number assigned to the table entry. The CounterChangeEntry has the OID counterChangeTable.1, which means that &lt;entrySubOid&gt; is 1.</p>
<p>The &lt;variableSubOid&gt; is a single number which can be thought to be the column of a specific variable. The counterChangeEpoch has &lt;variableSubOid&gt; 1, while counterChangeTimeString has &lt;variableSubOid&gt; 3.</p>
<p>The &lt;indexOid&gt; is the concatenation of the index variables (counterChangeEpoch and counterChangeMilliseconds), converted to OID. For example, if counterChangeEpoch was 123456789 and counterChangeMilliseconds was 512, the index would be "123456789.512". The index can be thought of as the identifier of the row in which the entry resides. In terms of a relational database it would be called the primary key of the record.</p>
<p>Thus, the full OID of the counterChangeTimeString in the entry 123456789.512, for example, would be ".1.3.6.1.4.1.42.2.1.3.123456789.512".</p>
<p>A table is implemented by creating a <a class="el" href="classagentxcpp_1_1_table.html">Table</a> object and tell it its &lt;tableOid&gt; (enterprises.42.2). An entry is implemented by subclassing <a class="el" href="classagentxcpp_1_1_table_entry.html">TableEntry</a>, such that the subclass initializes its <a class="el" href="classagentxcpp_1_1_table_entry.html#a526ad94530ebfcb9cb8948f38e098cde">TableEntry::subid</a> to &lt;entrySubOid&gt; (i.e. 1 for counterChangeEntry). For our table, we will implement the CounterChangeEntry class which contains the four variables counterChangeEpoch, counterChangeMilliseconds, counterChangeTimeString and counterChangeCounterValue. The CounterChangeEntry class must implement the <a class="el" href="classagentxcpp_1_1_table_entry.html#ae5d1d9467c3a4824024dfa80ea877796">TableEntry::indexVariables()</a> and <a class="el" href="classagentxcpp_1_1_table_entry.html#a06fdde3c972c0a336f97f381ef95c22c">TableEntry::variables()</a> methods.</p>
<p>Each time an entry is added to the table, the table will query the new entry for all its variables and add these to the MasterProxy object, so that they are served like any other variable. If an entry is removed from the table, the table will remove its variables from the MasterProxy object again. Neither the table nor the entry can actually be queried by SNMP requests; they are only used to organize the variables which can be queried. Therefore, neither the table nor the entries are added to the MasterProxy object. Only the variables are added.</p>
<h1><a class="anchor" id="tables_implementing_entry"></a>
Implementing the CounterChangeEntry class</h1>
<p>First of all, we implement the CounterChangeEntry class. Here is the full code of <code>CounterChangeEntry.hpp</code>:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#ifndef _COUNTERCHANGEENTRY_H_</span></div>
<div class="line"><span class="preprocessor">#define _COUNTERCHANGEENTRY_H_</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;agentxcpp/TableEntry.hpp&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;agentxcpp/IntegerVariable.hpp&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;agentxcpp/DisplayStringVariable.hpp&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceagentxcpp.html">agentxcpp</a>;</div>
<div class="line"></div>
<div class="line"><span class="keyword">class </span>CounterChangeEntry : <span class="keyword">public</span> <a class="code" href="classagentxcpp_1_1_table_entry.html">TableEntry</a></div>
<div class="line">{</div>
<div class="line">    <span class="keyword">public</span>:</div>
<div class="line">        QSharedPointer&lt;IntegerVariable&gt; counterChangeEpoch;</div>
<div class="line">        QSharedPointer&lt;IntegerVariable&gt; counterChangeMilliseconds;</div>
<div class="line">        QSharedPointer&lt;DisplayStringVariable&gt; counterChangeTimeString;</div>
<div class="line">        QSharedPointer&lt;IntegerVariable&gt; counterChangeValue;</div>
<div class="line"></div>
<div class="line">        CounterChangeEntry()</div>
<div class="line">        : counterChangeEpoch(new <a class="code" href="classagentxcpp_1_1_integer_variable.html">IntegerVariable</a>),</div>
<div class="line">          counterChangeMilliseconds(new <a class="code" href="classagentxcpp_1_1_integer_variable.html">IntegerVariable</a>),</div>
<div class="line">          counterChangeTimeString(new <a class="code" href="classagentxcpp_1_1_display_string_variable.html">DisplayStringVariable</a>),</div>
<div class="line">          counterChangeValue(new <a class="code" href="classagentxcpp_1_1_integer_variable.html">IntegerVariable</a>)</div>
<div class="line">        {</div>
<div class="line">            subid = 1;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">virtual</span> QVector&lt; QSharedPointer&lt;AbstractVariable&gt; &gt; indexVariables()</div>
<div class="line">        {</div>
<div class="line">            QVector&lt; QSharedPointer&lt;AbstractVariable&gt; &gt; result;</div>
<div class="line">            result &lt;&lt; counterChangeEpoch </div>
<div class="line">                   &lt;&lt; counterChangeMilliseconds;</div>
<div class="line">            <span class="keywordflow">return</span> result;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keyword">virtual</span> QMap&lt; quint32, QSharedPointer&lt;AbstractVariable&gt; &gt; variables()</div>
<div class="line">        {</div>
<div class="line">            QMap&lt; quint32, QSharedPointer&lt;AbstractVariable&gt; &gt; result;</div>
<div class="line">            result[1] = counterChangeEpoch;</div>
<div class="line">            result[2] = counterChangeMilliseconds;</div>
<div class="line">            result[3] = counterChangeTimeString;</div>
<div class="line">            result[4] = counterChangeValue;</div>
<div class="line">            <span class="keywordflow">return</span> result;</div>
<div class="line">        }</div>
<div class="line">};</div>
<div class="line"><span class="preprocessor">#endif // _COUNTERCHANGEENTRY_H_</span></div>
</div><!-- fragment --><p>The class inherits <a class="el" href="classagentxcpp_1_1_table_entry.html">TableEntry</a> and has four members which represent the four SNMP variables. Since in agentXcpp those variables are handled as QSharedPointer's, the constructor needs to create all of them using the <code>new</code> operator. The constructor also sets <a class="el" href="classagentxcpp_1_1_table_entry.html#a526ad94530ebfcb9cb8948f38e098cde">TableEntry::subid</a> to 1.</p>
<p>Our MIB states that counterChangeEpoch and counterChangeMilliseconds are used as index. The CounterChangeEntry::indexVariables() method implements this by returning these variables in a QVector, in the order in which they are used in the index. Note that the entry's OID changes if the index variables change their value. Our simpleagent will not change an entry after it was added to the table, though.</p>
<dl class="section note"><dt>Note</dt><dd>The variable types Counter32 and Counter64 are not allowed as index variables according to RFC 2578, 7.7.</dd></dl>
<p>The CounterChangeEntry::variables() method return all variables as a QMap. The map key will be used by the table as &lt;variableSubOid&gt; part for the variable.</p>
<h1><a class="anchor" id="tables_extending_simplecounter"></a>
Extending the SimpleCounter class.</h1>
<p>Next, we extent the SimpleCounter class so that it adds an entry to the table each time the counter is changed. First of all, we need additional includes:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;agentxcpp/Table.hpp&gt;</span></div>
<div class="line"><span class="preprocessor">#include &quot;CounterChangeEntry.hpp&quot;</span></div>
<div class="line"><span class="preprocessor">#include &lt;QDateTime&gt;</span></div>
</div><!-- fragment --><p>One thing to do is to add a <a class="el" href="classagentxcpp_1_1_table.html">Table</a> member, a member to store the entry just inserted into the table (needed for undoset(), a suitable constructor and the helper function addEntry():</p>
<div class="fragment"><div class="line"><span class="keyword">private</span>:</div>
<div class="line">    Table* table; <span class="comment">// may be the null pointer</span></div>
<div class="line">    QSharedPointer&lt;CounterChangeEntry&gt; lastInsertedEntry; <span class="comment">// for undoset()</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    SimpleCounter(Table* t = 0)</div>
<div class="line">    {</div>
<div class="line">        table = t;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordtype">void</span> addEntry()</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">// Add entry with new value to table</span></div>
<div class="line">        <span class="keywordflow">if</span>(table)</div>
<div class="line">        {</div>
<div class="line">            lastInsertedEntry = QSharedPointer&lt;CounterChangeEntry&gt;(<span class="keyword">new</span> CounterChangeEntry);</div>
<div class="line">            QDateTime timeStamp = QDateTime::currentDateTimeUtc();</div>
<div class="line">            lastInsertedEntry-&gt;counterChangeEpoch-&gt;setValue(timeStamp.toTime_t());</div>
<div class="line">            lastInsertedEntry-&gt;counterChangeMilliseconds-&gt;setValue(timeStamp.toMSecsSinceEpoch() - timeStamp.toTime_t()*1000);</div>
<div class="line">            lastInsertedEntry-&gt;counterChangeTimeString-&gt;setValue(timeStamp.toString(<span class="stringliteral">&quot;yyyy-MM-dd (dddd) hh:mm:ss.z&quot;</span>));</div>
<div class="line">            lastInsertedEntry-&gt;counterChangeValue-&gt;setValue(v);</div>
<div class="line">            table-&gt;addEntry(lastInsertedEntry);</div>
<div class="line">        }</div>
<div class="line">    }</div>
</div><!-- fragment --><p>Next we have to replace the <code>perform_get()</code>, <code>perform_commitset()</code> and <code>perform_undoset()</code> functions with variants adding and removing an entries to/from the table. Here is how they look like now:</p>
<div class="fragment"><div class="line"><span class="comment">// Replaces the first version:</span></div>
<div class="line"><span class="keyword">virtual</span> <span class="keywordtype">void</span> perform_get()</div>
<div class="line">{</div>
<div class="line">    ++v;</div>
<div class="line">    addEntry();</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">// Replaces the first version:</span></div>
<div class="line"><span class="keyword">virtual</span> <span class="keywordtype">bool</span> perform_commitset(qint32 new_value)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Remember old value for rollback</span></div>
<div class="line">    (*old_value) = v;</div>
<div class="line">    <span class="comment">// Set new value</span></div>
<div class="line">    v = new_value;</div>
<div class="line">    <span class="comment">// Add table entry</span></div>
<div class="line">    addEntry();</div>
<div class="line">    <span class="comment">// Operation succeeded</span></div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">// Replaces the first version:</span></div>
<div class="line"><span class="keyword">virtual</span> <span class="keywordtype">bool</span> perform_undoset(qint32 new_value)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Restore old value</span></div>
<div class="line">    v = *old_value;</div>
<div class="line">    <span class="comment">// Release old value</span></div>
<div class="line">    <span class="keyword">delete</span> old_value;</div>
<div class="line">    <span class="comment">// Remove table entry</span></div>
<div class="line">    <span class="keywordflow">if</span>(table)</div>
<div class="line">    {</div>
<div class="line">        table-&gt;removeEntry(lastInsertedEntry);</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">// Rollback succeeded</span></div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">}</div>
</div><!-- fragment --><p>And finally we update the main() function, where a table is instantiated and given to the SimpleCounter constructor. Here is the complete revised <code>main()</code> function:</p>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>** argv)</div>
<div class="line">{</div>
<div class="line">    QCoreApplication app(argc, argv);</div>
<div class="line"></div>
<div class="line">    MasterProxy master;</div>
<div class="line"></div>
<div class="line">    Oid simpleagentOid = Oid(<a class="code" href="classagentxcpp_1_1_oid.html#a8686f41f2f8225e0bb39a66944ad6f55">enterprises_oid</a>, <span class="stringliteral">&quot;42&quot;</span>);</div>
<div class="line">    master.register_subtree(simpleagentOid);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// NEW: Instantiate a table:</span></div>
<div class="line">    Table table(simpleagentOid + 2, &amp;master);</div>
<div class="line">    <span class="comment">// CHANGED: provide table when creating the counter:</span></div>
<div class="line">    QSharedPointer&lt;SimpleCounter&gt; counter(<span class="keyword">new</span> SimpleCounter(&amp;table));</div>
<div class="line">    Oid simpleCounterOid = simpleagentOid + 1 + 0;</div>
<div class="line">    master.add_variable(simpleCounterOid, counter);</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Code for sending notifications ---------------</span></div>
<div class="line">    NotificationSender sender(&amp;master, simpleCounterOid, counter);</div>
<div class="line">    QTimer timer;</div>
<div class="line">    QObject::connect(&amp;timer, SIGNAL(timeout()),</div>
<div class="line">                     &amp;sender, SLOT(sendNotification()));</div>
<div class="line">    timer.setInterval(1000); <span class="comment">// 1000 milliseconds</span></div>
<div class="line">    timer.start();</div>
<div class="line">    <span class="comment">// --------------------------------------------------</span></div>
<div class="line"></div>
<div class="line">    app.exec();</div>
<div class="line">}</div>
</div><!-- fragment --><p>And that's all we need for our table. Next, let's try it out.</p>
<h1><a class="anchor" id="tables_compiling_notification"></a>
Compiling the Subagent</h1>
<p>We didn't add implementation files in this tutorial, so no additional steps are needed for compiling. However, we have to recompile the whole thing. We know the following commands already from the previous tutorials:</p>
<div class="fragment"><div class="line">moc-qt4 `pkg-config --cflags QtCore QtNetwork` -o moc_NotificationSender.cc NotificationSender.hpp</div>
</div><!-- fragment --><div class="fragment"><div class="line">g++ -c moc_NotificationSender.cc `pkg-config --cflags QtCore QtNetwork`</div>
</div><!-- fragment --><div class="fragment"><div class="line">g++ simpleagent.cpp -o simpleagent moc_NotificationSender.o `pkg-config --cflags --libs QtNetwork QtCore` -lagentxcpp</div>
</div><!-- fragment --><p>Now, the executable is ready to run.</p>
<h1><a class="anchor" id="tables_running"></a>
Running the subagent</h1>
<p>The subagent is run like described in the previous tutorials, simply by executing it:</p>
<div class="fragment"><div class="line">./simpleagent</div>
</div><!-- fragment --><p>Now, let's add some entries to the table by querying the simpleCounter variable:</p>
<div class="fragment"><div class="line">snmpget -v1 -c rw localhost SIMPLE-MIB::simpleCounter.0</div>
</div><!-- fragment --><div class="fragment"><div class="line">snmpset -v1 -c rw localhost SIMPLE-MIB::simpleCounter.0 i 23</div>
</div><!-- fragment --><p>And finally we print the table using the snmptable command from the NET-SNMP package, which requires that the MIB is installed properly:</p>
<div class="fragment"><div class="line">snmptable -v2c -c rw localhost SIMPLE-MIB::counterChangeTable</div>
</div><!-- fragment --><p>If the MIB is not properly installed, or in case of programming errors, the snmptable command might return nothing. The snmpwalk command can help out in those cases, because it prints the complete subtree of a given OID, regardless whether it is a table or not:</p>
<div class="fragment"><div class="line">snmpwalk -v2c -c rw -On localhost 1.3.6.1.4.1.42.2</div>
</div><!-- fragment --><p>Now you know all you need to implement your own SNMP subagents. Use the API documentation to get more help on the individual classes.</p>
<p>Happy Hacking! </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.8 </li>
  </ul>
</div>
</body>
</html>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>AgentXcpp: The Variable Objects</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="doc_logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">AgentXcpp
   &#160;<span id="projectnumber">Version:0.3</span>
   </div>
   <div id="projectbrief">Internals Documentation</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('variables.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">The Variable Objects </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="variables_introduction"></a>
Introduction</h1>
<p>SNMP and AgentX are all about variables, and how to obtain or alter their values. In agentXcpp, variables are represented by objects which implement the <a class="el" href="classagentxcpp_1_1_abstract_variable.html">AbstractVariable</a> interface. The library provides some classes such as <a class="el" href="classagentxcpp_1_1_integer_variable.html">IntegerVariable</a> and <a class="el" href="classagentxcpp_1_1_octet_string_variable.html">OctetStringVariable</a>, all implementing <a class="el" href="classagentxcpp_1_1_abstract_variable.html">AbstractVariable</a>. These classes can directly be instantiated to serve as read-only variables (they do not support SNMP Set requests), and their value can be obtained with value() and altered with setValue().</p>
<p>However, it is normally more useful to derive from these classes and reimplement perform_get(), so that the value can be obtained in the moment a Get request occurs. Also, the <code>perform_testset()</code>, <code>perform_commitset()</code>, <code>perform_undoset()</code> and <code>perform_cleanupset()</code> methods can be reimplemented to add write support.</p>
<h1><a class="anchor" id="variables_get"></a>
How SNMP Get requests are served</h1>
<p>Each variable has an internal member to store its value, e.g. <a class="el" href="classagentxcpp_1_1_integer_variable.html#a3cda557609fee4ae4ccab8721722cf3c">IntegerVariable::v</a>. This value can be read with <code>value()</code> and set with <code>setValue()</code>. The <code>perform_get()</code> method is called by the library when an SNMP Get is requested for the variable. This method should then update the value to reflect the current state. The default <code>perform_get()</code> implementation does nothing and thus allows to read the value as set by the last call to setValue(). This makes it possible to use the Variable class without inheriting.</p>
<dl class="section note"><dt>Note</dt><dd>It is currently not possible to inhibit Get requests, i.e. it is not possible to implement write-only variables.</dd></dl>
<h2><a class="anchor" id="variables_get_internal"></a>
How Get requests are handled internally</h2>
<p>When the <a class="el" href="classagentxcpp_1_1_master_proxy.html">MasterProxy</a> object receives a Get (or GetNext) request, it looks up the variable registered with the requested OID. This works even for variables which are part of a table, because the <a class="el" href="classagentxcpp_1_1_table.html">Table</a> class registers its variables like any other variable. Then the MasterProxy invokes the variable's <a class="el" href="classagentxcpp_1_1_abstract_variable.html#a0ce9fd630d7c3c2c02aa794729a9059a">AbstractVariable::handle_get()</a> method to update the value of the variable. After that, it adds the variable to a <a class="el" href="classagentxcpp_1_1_varbind.html">Varbind</a> object which is then embedded into the response and sent back to the master agent (possibly with further varbinds).</p>
<p>The variable's <a class="el" href="classagentxcpp_1_1_abstract_variable.html#a0ce9fd630d7c3c2c02aa794729a9059a">AbstractVariable::handle_get()</a> method is implemented in the subclasses. It first calls <code>perform_get()</code> to update the internally stored value. The default implementation of <code>perform_get()</code> does nothing, but can be overridden by subclasses.</p>
<h1><a class="anchor" id="variables_set"></a>
How SNMP Set requests are served</h1>
<p>Each variable provides the functions <code>perform_testset()</code>, <code>perform_commitset()</code>, <code>perform_cleanupset()</code> and <code>perform_undoset()</code>, which are called while processing an SNMP Set request for the variable (see also <a class="el" href="how_to_add_rw_support.html#the_set_steps">The anatomy of a Set request</a>). Each of these functions takes the new value as parameter (e.g. an qint32 value for <a class="el" href="classagentxcpp_1_1_integer_variable.html">IntegerVariable</a>). The functions should then act as described in <a class="el" href="how_to_add_rw_support.html#the_set_steps">The anatomy of a Set request</a>, returning success or failure. It is not required that the functions update the internal member, because on Set request a subagent does not send the new state back to the master agent.</p>
<p>The default implementation of the Set-supporting methods is to fail with <a class="el" href="classagentxcpp_1_1_abstract_variable.html#a694943f11e149c4dd67206c8bc1af72fab8c95b2496fd48b8819468c1c42ca6fb">AbstractVariable::noAccess</a>, indicating that the variable is read-only. It is required to reimplement the methods in a derived class to enable write support.</p>
<h2><a class="anchor" id="variables_set_internal"></a>
How Set requests are handled internally</h2>
<p>When the <a class="el" href="classagentxcpp_1_1_master_proxy.html">MasterProxy</a> object receives a TestSet, CommitSet, CleanupSet or UndoSet request, it looks up the variable corresponding to the given OID and calls its <a class="el" href="classagentxcpp_1_1_abstract_variable.html#ac595ef1d4a8a786ffe53a12068892173">AbstractVariable::handle_testset()</a>, <a class="el" href="classagentxcpp_1_1_abstract_variable.html#a6b76943098a0c39ee7625a3045fc7af5">AbstractVariable::handle_commitset()</a>, <a class="el" href="classagentxcpp_1_1_abstract_variable.html#a795054bbf5bd0574ed3ed1c72de132ed">AbstractVariable::handle_cleanupset()</a> or <a class="el" href="classagentxcpp_1_1_abstract_variable.html#ad4c8a2c8c19621f04a3692ddd72f89fb">AbstractVariable::handle_undoset()</a> method, respectively. These methods are implemented in the subclasses of AbstractVariable. The first one, <code>handle_testset()</code>, is the only one which receives new new value, in form of a pointer to <a class="el" href="classagentxcpp_1_1_abstract_variable.html">AbstractVariable</a>, and stores it internally for later use. The other three methods then use the stored pointer to obtain access to the new value.</p>
<p>In particular, the <code>handle_testset()</code> method converts the pointer to <a class="el" href="classagentxcpp_1_1_abstract_variable.html">AbstractVariable</a> into a pointer to the more concrete class (e.g. <a class="el" href="classagentxcpp_1_1_gauge32_variable.html">Gauge32Variable</a> and stores it. Then, it calls the <code>perform_testset()</code> method. The <code>handle_commitset()</code> <code>handle_cleanupset()</code> and <code>handle_undoset()</code> methods only call <code>perform_commitset()</code>, <code>perform_cleanupset()</code> and <code>perform_undoset()</code>, respectively.</p>
<p>The default implementation of <code>perform_testset()</code> returns <a class="el" href="classagentxcpp_1_1_abstract_variable.html#a694943f11e149c4dd67206c8bc1af72fab8c95b2496fd48b8819468c1c42ca6fb">AbstractVariable::noAccess</a> to indicate that the variable is read-only. The method can be overridden by subclasses to enable write support. The default implementations of <code>perform_commitset()</code>, <code>perform_cleanupset()</code> and <code>perform_undoset()</code> all return false to indicate an error.</p>
<h1><a class="anchor" id="variables_serializing_parsing"></a>
Serializing and Parsing Variables</h1>
<p>The <a class="el" href="classagentxcpp_1_1_abstract_variable.html">AbstractVariable</a> interface provides the <a class="el" href="classagentxcpp_1_1_abstract_variable.html#a7a610124625cd035096e19a28403cfaa">AbstractVariable::serialize()</a> function to serialize a variable object. Parsing is done using parse constructors. This is the same mechanism as used by the PDU classes. See <a class="el" href="pdus.html">The PDU Objects</a> for a general explanation. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.8 </li>
  </ul>
</div>
</body>
</html>
